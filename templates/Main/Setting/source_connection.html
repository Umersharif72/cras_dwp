<div id="fetch_sourceConn" class="page hidden">
    <div class="container-fluid">
      <div class="heading-wrapper">
        <h1 class="mb-4">Source Connections</h1>
      </div>
      <div class="table-responsive table-wrapper">
        <table class="table table-striped table-dark" style="background-color: #d3e2f4">
          <thead class="table-header">
            <tr>
              <th>SID</th>
              <th>Jurisdiction</th>
              <th>DATABASES</th>
              <th>Src_DB_NAME</th>
              <th>Src_USER_NAME</th>
              <th>Src_PASSWRD</th>
              <th>Src_HOST</th>
              <th>Src_PORT</th>
              <th>Src_UPDATE_TIME</th>
              <th>Edit Connections</th>
            </tr>
          </thead>
          <form method="post">
            {% csrf_token %} {% for record in records %}
            <tr>
              <td class="table-data" id="id_sid">{{ record.SID }}</td>
              <td class="table-data" id="id_jurisdiction">
                {{ record.Jurisdiction }}
              </td>
              <td class="table-data" id="id_databases">
                {{ record.DATABASES }}
              </td>
              <td class="table-data" id="id_src_db_name">
                {{ record.Src_DB_NAME }}
              </td>
              <td class="table-data" id="id_src_user_name">
                {{ record.Src_USER_NAME }}
              </td>
              <td class="table-data" id="id_src_password">
                {{ record.Src_PASSWRD }}
              </td>
              <td class="table-data" id="id_src_host">
                {{ record.Src_HOST }}
              </td>
              <td class="table-data" id="id_src_port">
                {{ record.Src_PORT }}
              </td>
              <td class="table-data" id="id_src_update_time">
                {{ record.Src_UPDATE_TIME }}
              </td>
              <td>
                <button type="button" class="btn btn-primary edit-btn" data-toggle="modal" data-target="#editModal"
                  data-sid="{{ record.SID }}" data-jurisdiction="{{ record.Jurisdiction }}"
                  data-databases="{{ record.DATABASES }}" data-src_db_name="{{ record.Src_DB_NAME }}"
                  data-src_user_name="{{ record.Src_USER_NAME }}" data-src_passwd="{{ record.Src_PASSWRD }}"
                  data-src_host="{{ record.Src_HOST }}" data-src_port="{{ record.Src_PORT }}">
                  Edit
                </button>
              </td>
            </tr>
            {% endfor %}
          </form>
        </table>
      </div>

      <!-- Model for adding entry -->
      <div class="modal fade" id="addEntryModal" tabindex="-1" role="dialog" aria-labelledby="addEntryModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="addEntryModalLabel">
                Add Connection
              </h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <form method="post" style="background-color: #808080; padding: 20px">
                {% csrf_token %}
                <div class="form-group row">
                  <label for="Jurisdiction" class="col-sm-2 col-form-label">Jurisdiction</label>
                  <div class="col-sm-8 offset-sm-1">
                    <input type="text" class="form-control" id="Jurisdiction" name="Jurisdiction" required />
                  </div>
                </div>
                <div class="form-group row">
                  <label for="DATABASES" class="col-sm-2 col-form-label">DATABASES</label>
                  <div class="col-sm-8 offset-sm-1">
                    <input type="text" class="form-control" id="DATABASES" name="DATABASES" required />
                  </div>
                </div>
                <div class="form-group row">
                  <label for="Src_DB_NAME" class="col-sm-2 col-form-label">Src_DB_NAME</label>
                  <div class="col-sm-8 offset-sm-1">
                    <input type="text" class="form-control" id="Src_DB_NAME" name="Src_DB_NAME" required />
                  </div>
                </div>
                <div class="form-group row">
                  <label for="Src_USER_NAME" class="col-sm-2 col-form-label">Src_USER_NAME</label>
                  <div class="col-sm-8 offset-sm-1">
                    <input type="text" class="form-control" id="Src_USER_NAME" name="Src_USER_NAME" required />
                  </div>
                </div>
                <div class="form-group row">
                  <label for="Src_PASSWRD" class="col-sm-2 col-form-label">Src_PASSWRD</label>
                  <div class="col-sm-8 offset-sm-1">
                    <input type="password" class="form-control" id="Src_PASSWRD" name="Src_PASSWRD" required />
                  </div>
                </div>
                <div class="form-group row">
                  <label for="Src_HOST" class="col-sm-2 col-form-label">Src_HOST</label>
                  <div class="col-sm-8 offset-sm-1">
                    <input type="text" class="form-control" id="Src_HOST" name="Src_HOST" required />
                  </div>
                </div>
                <div class="form-group row">
                  <label for="Src_PORT" class="col-sm-2 col-form-label">Src_PORT</label>
                  <div class="col-sm-8 offset-sm-1">
                    <input type="number" class="form-control" id="Src_PORT" name="Src_PORT" required />
                  </div>
                </div>
                <div class="form-group row">
                  <div class="col-sm-8 offset-sm-3">
                    <button name="add_connection" type="submit" class="btn btn-primary">
                      Submit
                    </button>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>

      <!--Model for deleting entries-->

      <div class="modal fade" id="deleteConfirmationModal" tabindex="-1" role="dialog"
        aria-labelledby="deleteConfirmationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="deleteConfirmationModalLabel">
                Delete Connection
              </h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <form method="post" style="background-color: #808080; padding: 20px">
                {% csrf_token %}
                <div class="form-group row">
                  <label for="SID" class="col-sm-2 col-form-label">SID</label>
                  <div class="col-sm-8 offset-sm-1">
                    <input type="text" class="form-control" id="SID" name="SID" required />
                  </div>
                </div>
                <div class="modal-footer">
                  <button name="delete" type="submit" class="btn btn-danger" id="deleteConnectionButton">
                    Delete
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>

      <!-- Modal for Edit Form -->

      <!-- Modal for editing connection -->

      <div id="editModal" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Edit Connection</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <form id="editForm" method="post" action="{% url 'fetch_sourceConn' %}">
                {% csrf_token %}
                <input type="hidden" name="SID" id="edit_sid" />
                <div class="form-group">
                  <label for="edit_jurisdiction">Jurisdiction</label>
                  <input type="text" class="form-control" id="edit_jurisdiction" name="new_jurisdiction" />
                </div>
                <div class="form-group">
                  <label for="edit_databases">DATABASES</label>
                  <input type="text" class="form-control" id="edit_databases" name="new_databases" />
                </div>
                <div class="form-group">
                  <label for="edit_src_db_name">Src_DB_NAME</label>
                  <input type="text" class="form-control" id="edit_src_db_name" name="new_src_db_name" />
                </div>
                <div class="form-group">
                  <label for="edit_src_user_name">Src_USER_NAME</label>
                  <input type="text" class="form-control" id="edit_src_user_name" name="new_src_user_name" />
                </div>
                <div class="form-group">
                  <label for="edit_src_passwd">Src_PASSWRD</label>
                  <input type="text" class="form-control" id="edit_src_passwd" name="new_src_passwd" />
                </div>
                <div class="form-group">
                  <label for="edit_src_host">Src_HOST</label>
                  <input type="text" class="form-control" id="edit_src_host" name="new_src_host" />
                </div>
                <div class="form-group">
                  <label for="edit_src_port">Src_PORT</label>
                  <input type="text" class="form-control" id="edit_src_port" name="new_src_port" />
                </div>
                <button type="submit" class="btn btn-primary" name="edit">
                  Save changes
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>

      <script>
        // Populate the edit modal with the selected record's data
        document.querySelectorAll(".edit-btn").forEach((button) => {
          button.addEventListener("click", () => {
            document.getElementById("edit_sid").value =
              button.getAttribute("data-sid");
            document.getElementById("edit_jurisdiction").value =
              button.getAttribute("data-jurisdiction");
            document.getElementById("edit_databases").value =
              button.getAttribute("data-databases");
            document.getElementById("edit_src_db_name").value =
              button.getAttribute("data-src_db_name");
            document.getElementById("edit_src_user_name").value =
              button.getAttribute("data-src_user_name");
            document.getElementById("edit_src_passwd").value =
              button.getAttribute("data-src_passwd");
            document.getElementById("edit_src_host").value =
              button.getAttribute("data-src_host");
            document.getElementById("edit_src_port").value =
              button.getAttribute("data-src_port");
          });
        });
      </script>

      <!-- Button to trigger modal -->
      <div class="row mt-4">
        <div class="col-md-6">
          <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#addEntryModal">
            Add Connection
          </button>
          <button type="button" class="btn btn-secondary" data-toggle="modal" data-target="#deleteConfirmationModal">
            Delete Connection
          </button>
        </div>
      </div>
    </div>
  </div>
